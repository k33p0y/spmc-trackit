{% extends '../base.html' %}
{% load static %}

{% block extrastyle %}
<link rel="stylesheet" href="{% static 'src/css/dashboard.css' %}">
{% endblock %}

{% block content %}
<!-- Content Header -->
<section class="content-header">
	<div class="container-fluid">
		<div class="row mb-2">
			<div class="col-sm-6">
				<h5 class="font-weight-bolder">Dashboard</h5>
			</div>
			<div class="col-sm-6">
				<ol class="breadcrumb float-sm-right text-xs">
					<li class="breadcrumb-item active"><i class="fas fa-home"></i></li>
				</ol>
			</div>
		</div>
	</div>
</section>

<!-- /.content -->
<section class="content">
	<div class="container-fluid">
      
      <div class="row">
         <div class="col-12">
            <div class="card card-wrap shadow-sm">
               <div class="card-body p-3">
                  <div>
                     <p class="text-xs font-weight-bold text-uppercase mb-2 wrap-label">OVERVIEW</p>
                     <h6 class="font-weight-bold m-0">Track-it Web Application System</h6>
                     <small class="text-muted">Lorem ipsum, dolor sit amet consectetur adipisicing elit. Possimus totam commodi fugit facere cum eos voluptate doloremque voluptates sunt, fuga voluptatem recusandae molestias omnis nisi. Suscipit unde nesciunt quam dicta!</small>
                  </div>
                  <div class="icon-overlay"><i class="fas fa-thumbtack"></i></div>
               </div>
            </div>
         </div>
         <div class="col-12">
            <div class="card card-wrap shadow-sm">
               <div class="card-body p-3">
                  <div>
                     <p class="text-xs font-weight-bold text-uppercase mb-2 wrap-label">DEVELOPER</p>
                     <h6 class="font-weight-bold m-0">Integrated Hospital Operations and Management Program (IHOMP)</h6>
                     <small class="text-muted">Software and Systems Development Unit (SSD)</small>
                  </div>
                  <div class="icon-overlay"><i class="fas fa-laptop-code"></i></div>
               </div>
            </div>
         </div>
      </div>
       
      {% if user.is_superuser %}
      <div class="row">
         <div class="col-12 col-lg-7 col-xl-8">
            <div class="card card-dash">
               <div class="card-header d-flex align-items-center p-2 pl-3 pr-3"> 
                  <div class="card-title m-0"> Latest Requests </div>
                  <div class="ml-auto">
                     <a href="{% url 'create_ticket' %}" class="btn btn-xs btn-light" id="btn-create-list"><i class="fas fa-xs fa-plus"></i> <span class="d-none d-sm-inline ml-1">Create Request</span></a>
                  </div>
               </div>
               <div class="card-body p-0">
                  <table id="dt_requests" class="table" width="100%">
                     <thead>
                        <tr>
                           <th>Ticket No</th>
                           <th>Request Type</th>
                           <th>Category</th>
                           <th>Status</th>
                           <th>Requested By</th>
                        </tr>
                     </thead>
                     <tbody>
                        {% for ticket in tickets %}
                        <tr>
                           <td>{{ticket.ticket_no}}</td>
                           <td><h6 class="m-0"><span class="badge text-light p-1" style="background-color:{{ticket.request_form.color}}">{{ticket.request_form}}</span></h6></td>
                           <td>{{ticket.category}}</td>
                           <td>{{ticket.status}}</td>
                           <td>{{ticket.requested_by}}</td>
                        </tr>
                        {% endfor %}
                     </tbody>
                  </table>
               </div>
               <div class="card-footer d-flex justify-content-end pt-2 pb-2">
                  <a href="{% url 'ticket' %}" class="text-xs text-secondary align-self-center"> View All <i class="fas fa-caret-right"></i></a>
               </div>
            </div>
         </div>

         <!-- Users -->
         <div class="col-12 col-lg-5 col-xl-4">
            <div class="card card-dash">
               <div class="card-header p-2 pl-3 pr-3"> 
                  <div class="card-title m-0"> Latest Users</div> 
               </div>
               <div class="card-body p-1">
                  <div class="d-flex flex-wrap">
                     {% for user in users %}
                     <div class="col-3 item-col text-center p-2">
                        <div class="item-image {% if user.is_staff %} staff {% endif %}">{{user.first_name|make_list|first}}{{user.last_name|make_list|first}}</div>
                        <p class="item-name m-0 mt-1">{{user}}</p>
                        <div class="item-date text-muted mt-1">{{user.date_joined|date:"d M"}}</div>
                     </div>
                     {% endfor %}
                  </div>
               </div>
               <div class="card-footer d-flex justify-content-end pt-2 pb-2">
                  <a href="{% url 'user_list' %}" class="text-xs text-secondary align-self-center"> View All <i class="fas fa-caret-right"></i></a>
               </div>
            </div>
         </div>
      </div>
      {% endif %}
	</div>
</section>
<!-- /.content -->
{% endblock %}

{% block extrascript %}
<script type="text/javascript" src="{% static 'src/js/dashboard.js' %}"></script>
{% endblock %}